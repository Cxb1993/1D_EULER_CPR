MODULE MODULE_CORRECTIONPOLYNOMIAL
    USE MODULE_PRECISION
    
    TYPE, PUBLIC :: CORRECTIONPOLYNOMIAL
        
        INTEGER(IP) :: ORDER
        REAL(WP), DIMENSION(:), POINTER  :: GLB
        REAL(WP), DIMENSION(:), POINTER  :: GRB
        
    CONTAINS

    PROCEDURE    :: MAKE => MAKE_CORRECTIONPOLYNOMIAL
    PROCEDURE    :: DELETE => DELETE_CORRECTIONPOLYNOMIAL
    
    END TYPE CORRECTIONPOLYNOMIAL
    
    CONTAINS
    
    SUBROUTINE MAKE_CORRECTIONPOLYNOMIAL(THIS, ORDER)
    IMPLICIT NONE
    CLASS(CORRECTIONPOLYNOMIAL), INTENT(INOUT)  :: THIS
    INTEGER(IP), INTENT(IN) :: ORDER
    INTEGER(IP) :: N1, I
    
    THIS%ORDER = ORDER
    N1 = ORDER + 1
    
    ALLOCATE(THIS%GLB(N1))
    ALLOCATE(THIS%GRB(N1))
    
    IF (ORDER == 0) THEN 
        THIS%GLB(1) = -0.5_WP
    ELSE IF (ORDER == 1) THEN 
        THIS%GLB(1) = -2._WP
        THIS%GLB(2) = 1._WP
    ELSE IF (ORDER == 2) THEN 
		THIS%GLB(1) = -4.5_WP
		THIS%GLB(2) = 0.75_WP
		THIS%GLB(3) = -1.5_WP        
    ELSE IF (ORDER == 3) THEN 
		this%glb(1) = -8._WP;
		this%glb(2) = 0.894427190999916_WP;
		this%glb(3) = -0.894427190999916_WP;
		this%glb(4) = 2.000000000000000_WP;
    ELSE IF (ORDER == 4) THEN 
		this%glb(1) = -12.500000000000000_WP
		this%glb(2) = 1.071428571428571_WP
		this%glb(3) = -0.937500000000000_WP
		this%glb(4) = 1.071428571428571_WP
		this%glb(5) = -2.500000000000000_WP        
    ELSE IF (ORDER == 5) THEN 
		this%glb(1) = -18.000000000000000_WP
		this%glb(2) = 1.259090802393860_WP
		this%glb(3) = -1.039883175166253_WP
		this%glb(4) = 1.039883175166253_WP
		this%glb(5) = -1.259090802393862_WP
		this%glb(6) = 3.000000000000000_WP        
    ELSE IF (ORDER == 6) THEN 

		this%glb(1) = -24.500000000000000_WP
		this%glb(2) = 1.451626611323438_WP
		this%glb(3) = -1.162370412976332_WP
		this%glb(4) = 1.093750000000000_WP
		this%glb(5) = -1.162370412976332_WP
		this%glb(6) = 1.451626611323440_WP
		this%glb(7) = -3.500000000000000_WP        
    ELSE IF (ORDER == 7) THEN 
		this%glb(1) = -32.000000000000000_WP
		this%glb(2) = 1.646813245455385_WP
		this%glb(3) = -1.294272340806527_WP
		this%glb(4) = 1.177038562354133_WP
		this%glb(5) = -1.177038562354133_WP
		this%glb(6) = 1.294272340806526_WP
		this%glb(7) = -1.646813245455381_WP
		this%glb(8) = 4.000000000000000_WP        
    ELSE IF (ORDER == 8) THEN 
		this%glb(1) = -40.500000000000000_WP
		this%glb(2) = 1.843607008227080_WP
		this%glb(3) = -1.431394905143639_WP
		this%glb(4) = 1.274249435378094_WP
		this%glb(5) = -1.230468750000000_WP
		this%glb(6) = 1.274249435378094_WP
		this%glb(7) = -1.431394905143638_WP
		this%glb(8) = 1.843607008227083_WP
		this%glb(9) = -4.500000000000002_WP        
    ELSE IF (ORDER == 9) THEN 
		this%glb(1) = -50.000000000000000_WP
		this%glb(2) = 2.041450781795803_WP
		this%glb(3) = -1.571734950051846_WP
		this%glb(4) = 1.379242344610341_WP
		this%glb(5) = -1.302362052293982_WP
		this%glb(6) = 1.302362052293982_WP
		this%glb(7) = -1.379242344610340_WP
		this%glb(8) = 1.571734950051850_WP
		this%glb(9) = -2.041450781795814_WP
		this%glb(10) = 4.999999999999996_WP        
    ELSE IF (ORDER == 10) THEN 
		this%glb(1) = -60.500000000000000_WP
		this%glb(2) = 2.240019259474176_WP
		this%glb(3) = -1.714207384864337_WP
		this%glb(4) = 1.489064083963912_WP
		this%glb(5) = -1.384624051179488_WP
		this%glb(6) = 1.353515625000000_WP
		this%glb(7) = -1.384624051179487_WP
		this%glb(8) = 1.489064083963914_WP
		this%glb(9) = -1.714207384864336_WP
		this%glb(10) = 2.240019259474186_WP
		this%glb(11) = -5.500000000000004_WP    
    ELSE IF (ORDER == 11) THEN 
		this%glb(1) = -72.000000000000000_WP
		this%glb(2) = 2.439109405612857_WP
		this%glb(3) = -1.858170261712427_WP
		this%glb(4) = 1.602105877713413_WP
		this%glb(5) = -1.473343869993111_WP
		this%glb(6) = 1.417653739264046_WP
		this%glb(7) = -1.417653739264047_WP
		this%glb(8) = 1.473343869993112_WP
		this%glb(9) = -1.602105877713410_WP
		this%glb(10) = 1.858170261712421_WP
		this%glb(11) = -2.439109405612830_WP
		this%glb(12) = 6.000000000000000_WP        
    ELSE
        WRITE(*, *) "PROGRAM DOES NOT SUPPORT THIS ORDER", ORDER
        STOP
    END IF
    
    FORALL (I = 1:N1)
        THIS%GRB(I) = -THIS%GLB(ORDER+2-I)
    END FORALL
    
        
    END SUBROUTINE MAKE_CORRECTIONPOLYNOMIAL
    
    SUBROUTINE DELETE_CORRECTIONPOLYNOMIAL(THIS)
    IMPLICIT NONE
    CLASS(CORRECTIONPOLYNOMIAL), INTENT(INOUT)  :: THIS
    THIS%ORDER = 0
    DEALLOCATE(THIS%GLB)
    DEALLOCATE(THIS%GRB)
    END SUBROUTINE DELETE_CORRECTIONPOLYNOMIAL
END MODULE     MODULE_CORRECTIONPOLYNOMIAL